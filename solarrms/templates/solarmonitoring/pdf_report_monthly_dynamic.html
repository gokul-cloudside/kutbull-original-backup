{% load screamshot %}
<!DOCTYPE html>
<!-- saved from url=(0065)http://dataglen.com/solar/plant/ranergy/pdf_report/?st=11-11-2017 -->
<html lang="en" class="gr__dataglen_com">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Monthly Generation Report by {{ client_name }}</title>
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <meta name="description" content="">
      <meta name="viewport" content="initial-scale = 1.0, maximum-scale=1.0">
      <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
      <script src="https://code.highcharts.com/highcharts.js"></script>
      <script>
         var runOnLoad = (function() {
             var tasksRun = false;
             var tasks = [];

             function add(task) { if (tasksRun) { window.setTimeout(task, 0) } else { tasks.push(task) } }

             function runTasks() { tasksRun = true; while (tasks.length) { tasks.shift()() } }
             if (window.addEventListener) {
                 document.addEventListener('DOMContentLoaded', runTasks, false);
                 window.addEventListener('load', runTasks, false)
             } else { window.attachEvent('onload', runTasks) }
             return add
         })();
      </script>
      <style>
         #main {
         display: flex;
         flex-direction: column;
         }
      </style>
      <style>
         /*css reset*/
         html,
         body,
         div,
         span,
         applet,
         object,
         iframe,
         h1,
         h2,
         h3,
         h4,
         h5,
         h6,
         p,
         blockquote,
         pre,
         a,
         abbr,
         acronym,
         address,
         big,
         cite,
         code,
         del,
         dfn,
         em,
         img,
         ins,
         kbd,
         q,
         s,
         samp,
         small,
         strike,
         strong,
         sub,
         sup,
         tt,
         var,
         b,
         u,
         i,
         center,
         dl,
         dt,
         dd,
         ol,
         ul,
         li,
         fieldset,
         form,
         label,
         legend,
         table,
         caption,
         tbody,
         tfoot,
         thead,
         tr,
         th,
         td,
         article,
         aside,
         canvas,
         details,
         embed,
         figure,
         figcaption,
         footer,
         header,
         hgroup,
         menu,
         nav,
         output,
         ruby,
         section,
         summary,
         time,
         mark,
         audio,
         video {
         margin: 0;
         padding: 0;
         border: 0;
         font-size: 100%;
         font: inherit;
         vertical-align: baseline;
         }
         /* HTML5 display-role reset for older browsers */
         article,
         aside,
         details,
         figcaption,
         figure,
         footer,
         header,
         hgroup,
         menu,
         nav,
         section {
         display: block;
         }
         body {
         line-height: 1;
         }
         ol,
         ul {
         list-style: none;
         }
         blockquote,
         q {
         quotes: none;
         }
         blockquote:before,
         blockquote:after,
         q:before,
         q:after {
         content: '';
         content: none;
         }
         table {
         border-collapse: collapse;
         border-spacing: 0;
         }
         html {
         box-sizing: border-box;
         }
         *,
         *:before,
         *:after {
         box-sizing: inherit;
         }
         /*font family*/
         @import url('https://fonts.googleapis.com/css?family=Montserrat:400,600,800');
         @media print,
         screen {
         body {
         font-family: arial, sans-serif;
         height: 752px;
         width: 595px;
         margin-left: auto;
         margin-right: auto
         }
         .clearfix {
         overflow: auto;
         }
         .clearfix::after {
         content: "";
         clear: both;
         display: table;
         }
         .header {
         display: flex;
         align-items: center;
         }
         .header-logo-left,
         .header-logo-right {
         width: 20%;
         max-height: 100px;
         }
         .header-logo-left img,
         .header-logo-right img {
         width: 100px;
         }
         .header-logo-left {
         float: left;
         }
         .header-logo-right {
         float: right;
         }
         .header-site--name {
         text-align: center;
         width: 50%;
         float: left;
         font-size: 10px;
         line-height: 20px;
         font-weight: 600;
         padding: 0 10px;
         }
         .header-name-center {
         text-align: center;
         width: 80%;
         font-size: 10px;
         line-height: 20px;
         font-weight: 600;
         padding: 0 10px;
         }
         .block-title {
         font-weight: 500;
         font-size: 8px;
         letter-spacing: 0.6px;
         margin: 10px 0px;
         font-weight: bold;
         }
         .address_wrapper {
         display: -webkit-flex;
         display: flex;
         -webkit-flex-flow: row wrap;
         flex-flow: row wrap;
         margin-top: 10px;
         }
         .address_item {
         -webkit-flex: 1 auto;
         flex: 1 auto;
         font-size: 10px;
         margin: 5px 0px;
         }
         .address_item span {
         font-weight: 800;
         margin-right: 5px;
         }
         h3 {
         margin-bottom: 15px;
         margin-top: 10px;
         font-weight: bold;
         font-size: 14px;
         }
         .light {
         color: #909090;
         margin-top: 5px;
         font-size: 8px;
         font-weight: 400;
         }
         table.blueTable {
         border: 1px solid #1C6EA4;
         background: #4ab19a;
         width: 100%;
         text-align: right;
         border-collapse: collapse;
         border-right: none;
         border-left: none;
         table-layout: fixed;
         }
         table.blueTable td,
         table.blueTable th {
         padding: 6px 10px;
         word-wrap: break-word;
         }
         table.blueTable tbody td {
         font-size: 8px;
         font-weight: 500;
         }
         table.blueTable tbody tr {
         background: #fff
         }
         table.blueTable thead th {
         font-size: 7px;
         font-weight: 600;
         color: white;
         word-wrap: break-word;
         }
         table.blueTable thead th:first-child {
         width: 120px;
         max-width: 120px;
         min-width: 120px;
         }
         table.blueTable tfoot td {
         font-size: 8px;
         background-color: #f2f2f2;
         font-weight: bold;
         }
         section {
         margin: 10px 0px;
         }
         .inline-block {
         display: inline-block;
         }
         }
         @import 'https://code.highcharts.com/css/highcharts.css';
         #container {
         margin: 0 auto;
         }
         .highcharts-yaxis-grid .highcharts-grid-line {
         stroke-width: 1px;
         stroke: #d8d8d8;
         }
         .highcharts-yaxis .highcharts-tick {
         stroke-width: 1px;
         stroke: #d8d8d8;
         }
         .highcharts-minor-grid-line {
         stroke-dasharray: 2, 2;
         }
      </style>
   </head>
   <body data-gr-c-s-loaded="true">
      <div >
         <hr>
         <table style="width:100%; margin-top: 10px;line-height: 1.2; font-size: 10px; border-spacing: 10px 10px;">
            <tr style="vertical-align: middle; ">
               <td width="50%" align="left"><img style="display: block;
                  max-width:100px;
                  max-height:45px;
                  object-fit: contain; margin-bottom: 5px;" src="{{ plant_client_logo }}">
               </td>
               <td width="50%" align="right"> <img style="display: block;
                  max-width:100px;
                  max-height:45px;
                  object-fit: contain;margin-bottom: 5px;" src="{{ plant_group_client_logo }}"></td>
            </tr>
            <tr>
               <td  align="left" valign="top">AMR Report</br>
                  from {{ client_name }}</br>
                  <span style="font-weight: bold"> Date: </span> {{ starttime }} to {{ endtime }}
               </td>
               <td  align="right" valign="top"><span style="font-weight: bold"> Plant: </span>{{ plant_name }}</br>
                  <span style="font-weight: bold"> Capacity:</span> {{ plant_capacity }}kWp</br>
                  <span style="font-weight: bold"> Address:</span> {{ plant_address }}
               </td>
            </tr>
         </table>
         <hr>
      </div>
      <div id="main">

         <div id="section1">
            {% if energy_meter_order <= 100 %}
            <section>
            {% else %}
            <section style="display: none">
               {% endif %}
               <div class="block-title">{{ energy_meter_order }} - Energy Meter Counter Values (from {{ starttime }} to {{ endtime }})</div>
               <table class="blueTable">
                  <thead>
                     <tr>
                        <th>{{ title_group_name }}</th>
                        <th>Meter Name</th>
                        <th>AC Capacity (kW)</th>
                        <th>Energy Meter Counter Closing Reading for the Month {{ endtime }} = B (kWh) </th>
                        <th>Energy Meter Counter Opening Reading for the Month {{ starttime }} = A (kWh)</th>
                        <th>Billing Units C kWh)= B - A</th>
                     </tr>
                  </thead>
                  <tbody>
                  {% for group_data in group_meter_energy_data %}
                     <tr>
                        <td>{{ group_data.group_name }}</td>
                        <td>{{ group_data.name }}</td>
                        <td>{{ group_data.group_capacity }}</td>
                        <td>{{ group_data.endtime_meter_reading }}</td>
                        <td>{{ group_data.starttime_meter_reading }}</td>
                        <td>{{ group_data.total_billing_units }}</td>
                     </tr>
                     {% endfor %}
                  </tbody>
                  <tfoot>
                     <tr>
                        <td>Total</td>
                        <td></td>
                        <td>{{ plant_total_capacity_meter }}</td>
                        <td></td>
                        <td></td>
                        <td>{{ plant_total_generation_from_meter }}</td>
                     </tr>
                  </tfoot>

               </table>
            </section>
         <p class="light" ><sup>*</sup> Note: If one group is having more than one meter please verify the capacity. If only one meter is present, plant level data is shown. </p>

         </div>

         <!--<div id="section2">-->
            <!--{% if inverter_data_order <= 100 %}-->
            <!--<section>-->
            <!--{% else %}-->
            <!--<section style="display: none">-->
               <!--{% endif %}-->
               <!--<div class="block-title">{{ inverter_data_order }} - Inverter Counter Values (from {{ starttime }} to {{ endtime }})</div>-->
               <!--<table class="blueTable">-->
                  <!--<thead>-->
                     <!--<tr>-->
                        <!--<th>Group Name</th>-->
                        <!--<th>Inverter Name</th>-->
                        <!--<th>Capacity (kWh)</th>-->
                        <!--<th>Inverter Counter Closing Reading for the Month {{ endtime }} = B (kWh) </th>-->
                        <!--<th>Inverter Counter Opening Reading for the Month {{ starttime }} = A (kWh)</th>-->
                        <!--<th>Billing Units C kWh)= B - A</th>-->
                     <!--</tr>-->
                  <!--</thead>-->
                  <!--<tbody>-->
                  <!--{% for inverter in list_of_all_inverters_info %}-->
                     <!--<tr>-->
                        <!--<td>{{ inverter.group_name }}</td>-->
                        <!--<td>{{ inverter.name }}</td>-->
                        <!--<td>{{ inverter.capacity }}</td>-->
                        <!--<td>{{ inverter.endtime_inverter_reading }}</td>-->
                        <!--<td>{{ inverter.starttime_inverter_reading }}</td>-->
                        <!--<td>{{ inverter.total_billing_units_inverters }}</td>-->
                     <!--</tr>-->
                     <!--{% endfor %}-->

                  <!--</tbody>-->
                   <!--<tfoot>-->
                     <!--<tr>-->
                        <!--<td>Total </td>-->
                        <!--<td></td>-->
                        <!--<td>{{ total_inverter_cacpacity }}</td>-->
                        <!--<td></td>-->
                        <!--<td></td>-->
                        <!--<td>{{ total_inverter_billing_units }}</td>-->
                     <!--</tr>-->
                  <!--</tfoot>-->
               <!--</table>-->
            <!--</section>-->
         <!--</div>-->

      </div>
      <!--<p class="light"><sup>*</sup> Note: The values present are as per availability of data. The sum of all Inverters capacity can be more than plant capacity. </p>-->
      <script>
         document.getElementById("section1").style.order = {{ energy_meter_order }};
         <!--document.getElementById("section2").style.order = {{ inverter_data_order }};-->
         setTimeout(function() { document.getElementById("footer_content").innerHTML = "<div id='jscompleted'>"; }, 2000);
      </script>

      <div id="footer_content"></div>
   </body>
</html>

